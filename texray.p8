pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
function _init()
	cls(0)
	p={x=64,y=60,sx=0,sy=0,i=2}
 bt={{t=0,s=-2,i=9,d=20,m=5},
    {t=1,s=-6,i=14,d=8,m=2},
    }
 bp=1
 b=bt[1]
 bulets={}

 shoot_timer=0
 
 
 f={icon=4}
	
	muzzle=0 

 score=30000
 lives=3
 bombs=2
 
 starx={}
 stary={}
 starspeed={}
 for i=1,100 do
  add(starx,flr(rnd(128)))
  add(stary,flr(rnd(128)))
  add(starspeed,rnd(1.5)+.5)
 end
end

function _update()
 p.sx=0
 p.sy=0
 p.i=2
 
 --animate flame
 f.icon=4+f.icon%5

 --animate bullets
 for i=1,#bulets do
  local t=bulets[i]
  t.ai=t.i+t.ai%5
 end
 
 --animate muzzle flash
 muzzle-=1
 
 shoot_timer=max(shoot_timer-1,0)
 
 --controls
 if (btn(0)) then
  p.sx=-1
  p.i=1
 end
 
 if (btn(1)) then
  p.sx=1
  p.i=3
 end
 
 if (btn(2)) then
  p.sy=-1
 end
 
 if (btn(3)) then
  p.sy=1
 end
 
 if btnp(4) then
  bp=1+bp%#bt 
 end 
 
 if btn(5) and shoot_timer<=0 then
  muzzle=bt[bp].m
  shoot(bt[bp])
  shoot_timer=bt[bp].d
 end 
 
 --collisions
 if (p.x < -7) then
 	p.x=127
 end
 
 if (p.x > 127) then
 	p.x=0
 end

 if (p.y < -7) then
 	p.y=127
 end
 
 if (p.y > 127) then
 	p.y=0
 end 
 
 --steps
 p.x+=p.sx
 p.y+=p.sy
 for i=1,#bulets do
  bulets[i].y+=bulets[i].s
 end
 animatestars()
 for i=1,#bulets do
  if bulets[i]!=nil 
  and bulets[i].y<-20 then
   del(bulets,bulets[i])
  end
 end
end

function _draw()
 cls(0)
	starfield()
	spr(p.i,p.x,p.y)
	spr(f.icon,p.x,p.y+8)

 
 drawbulets()
 
 circfill(p.x+3,p.y-2,muzzle,7)

 print("score: "..score,40,2,12)
 
 for i=1,3 do
  if lives>=i then
   spr(25,i*9-8,1)
  else
   spr(26,i*9-8,1)
  end
 end
 
 print("type:",92,122)
 spr(47+bp,113,120)
 for i=1,3 do
  if bombs>=i then
   spr(27,i*9+90,1)
  else
   spr(28,i*9+90,1)
  end
 end
-- print(bp,64,64,7)
end

function shoot(b)
 sfx(b.t)
 -- gen bullet  
 add(bulets,{x=p.x,y=p.y-8,s=b.s,i=b.i,t=b.t,ai=b.i})
end
-->8
function starfield()
 for i=1,#starx do
  local sp=starspeed[i]
  
  if sp<1.5 then
   scol=12
  end
  if sp<1.25 then
   scol=13
  end
  if sp<1 then
   scol=1
  end
  
  if sp<1.5 then
   pset(starx[i],stary[i],scol)
  else
   line(starx[i],stary[i],starx[i],stary[i]+2,14)
  end
 end
end

function animatestars()
 for i=1,#stary do
  local sy=stary[i]
  sy+=starspeed[i]
  if sy>128 then
   sy-=128
  end
  stary[i]=sy
 end
end

function drawbulets()
 for i=1,#bulets do
  local b=bulets[i]
  spr(b.ai,b.x,b.y)
 end
end


__gfx__
00000000000100000001100000001000000000000000000000000000000000000000000000dccd00000dd00001dccd10000dd00000dccd000007700000770000
00000000000910000019610000019000000990000099000000990000000099000009900002c77c2002dccd201dccccd102dccd2002c77c200006600000660000
007007000099d10001d99d10001d9900029aa90000aa000000aa00000000aa00009aa92002c77c200dc77cd0dc7777cd0dc77cd002c77c200000000000000000
0007700001dd8210128dd8210128dd10000770000077000000770000000077000007700002c77c20dcc77ccdcc7777ccdcc77ccd02c77c200007700000007700
0007700002ee8220228ee8220228ee20000000000060000000600000000066000000000002c77c20dcc77ccdcc7777ccdcc77ccd02c77c200006600000006600
0070070002eed22022deed22022dee20000000000000000000000000000000000000000002c77c200dc77cd0dc7777cd0dc77cd002c77c200000000000000000
000000000111d21012d11d21012d1110000000000000000000000000000000000000000000dccd0002dccd201dccccd102dccd2000dccd000007700000770000
000000000010110001100110001101000000000000000000000000000000000000000000002dd200000dd00001dccd10000dd000002dd2000006600000660000
00077000000077000007700000010000000100000001100000001000000010000000000008800880088008800000198000810080000000000000000000000000
0006600000006600000660000009000000091000001961000001900000009000000000008888888880088008000108a981099100000000000000000000000000
000000000000000000000000009910000099d10001d99d10001d9900000199000000000088888888800000080011118011a1a110000000000000000000000000
00077000007700000007700000d8210001dd8210128dd8210128dd1000128d000000000088888888800000080111611011a77a98000000000000000000000000
00066000006600000006600001e8220002ee8220228ee8220228ee2000228e100000000008888880080000801111161189a77a01100000000000000000000000
00000000000000000000000001ee220002eed22022deed22022dee200022ee100000000000888800008008001611116108111a11100000000000000000000000
000770000000770000077000001111000111d21012d11d21012d11100011110000000000000880000008800001611110109aa901000000000000000000000000
00066000000066000006600000101000001011000110011000110100000101000000000000000000000000000011110008011180000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000de2002ed0000000000000000000000000000000000000000
001dd1000000000000000000000000000000000000000000000000000000000000000000000000001e5225e10000000000000000000000000000000000000000
01dccd10000000000000000000000000000000000000000000000000000000000000000000000000d015510d0000000000000000000000000000000000000000
0dc77cd0670670670000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000
0dc77cd0670670670000000000000000000000000000000000000000000000000000000000000000d521125d0000000000000000000000000000000000000000
01dccd100000000000000000000000000000000000000000000000000000000000000000000000001e5aa5e10000000000000000000000000000000000000000
001dd100000000000000000000000000000000000000000000000000000000000000000000000000e005500e0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000d002200d0000000000000000000000000000000000000000
__label__
0000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000
0088008800088008800088008800000000e000000000000000000000000000000000000000000000000000000000000000000001980000001980000810080000
0888888880888888880888888880000000e000000cc00cc00cc0ccc0ccc000000000ccc0ccc0ccc0ccc0ccc000000000000000108a90000108a9081099100000
0888888880888888880888888880000000000000c000c000c0c0c0c0c0000c00000000c0c0c0c0c0c0c0c0c00000000000000111180000111180011a1a110000
0888888880888888880888888880000000000000ccc0c000c0c0cc00cc00000000000cc0c0c0c0c0c0c0c0c00000000000001116110001116110011a77a98000
008888880008888880008888880000000000000000c0c000c0c0c0c0c0000c00000000c0c0c0c0c0c0c0c0c00000000000011111611011111611089a77a01000
0008888000008888000008888000000000000000cc000cc0cc00c0c0ccc000000000ccc0ccc0ccc0ccc0ccc00000000000016111161016111161008111a11000
000088000000088000000088000000000000000000000000000000000000000000000000000000000000000000000000000016111100016111100109aa901000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000111100008011180000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0000000000000
000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000e0000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000
000000000000000000000e0000000000000000000000000000000000000000000000000000000000000e0000000000000000000000e0000000000000c0000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000e000000000000000000000
000000000000000000000000000000000000000000000000000000000000000c0000000000e000000000000000000000000e000000e000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000001000e000000000000000000000000e0000000000000000000000000000
00000000000001000000c00000000000000000000000000000000000000000000000000000e000000000000000000000000e0000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000e00000000000000000000000
0000000000000000000000000000000000000010000000000000000000000000000000000000000000e000000000000000000000e00000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000
0000000000100000000000000000000000000000000000000010000e000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000000d0100
0000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0000000000000000000
0000000000000000000000e0000000000000000000000000000000000e000000000000000000000000000000e000000000000000000000000000000000000000
0000000000000000000001e0000000000000000000000000000000000e000000000000000000000000010000e000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000e000000000000000000000000000000000000000
000000000000000000000000000000000c00000000000000000000000000000000000000e0000c00000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000e00000d0000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000e00000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000e00000000000000d0000000000000000000e00000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000e1000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000d000000000000000000000001000000000000000000000000000000000000000000000000000e000000000000
0000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000e000000000000
0000000000000000000000000000000000000000000e000000000000000000000000000000100000000000000000000000000000c0000000000e000000000000
0000000000000000000000000000000000000000000e00000000000000000000000000000d0000000000000000000000000000000000000000000e0000000000
0000000000e00000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000e0000e0000000000
0000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000d0000000000000000000000e0000e0000000000
0000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000
000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000
00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000e000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000e000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000e0000000000000000000000000000000000000000000000000000c00000c00000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000
00000000000000c0000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e0000000000000000
000000000000000000000000000000000000000000000e000000e00000000000000000000000000000e0000000000000000000000000000e0000000000000000
000000000000000000000000000000000000000000000e000000e000000000100000e0000000000000e0000000000000000000000000000e0000000000000000
e00000000000000000000000000000000000000000000e000000e000000000000000e0000000000000e000000000000000000000000000000000000000000000
e0000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000
e000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000e00000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000e00000000000000000000000000e00000d000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000e00000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e00000000000000000000000000000000000000000000000000000001100000000000e00000000000000000000c0000000000000000000000000000000000000
e00000000000000000000000000000000000000c00000000000000019610000000000e0000000000000000000000000000000000000000000000000000000000
e000000000000000000000000000000000000000000000000000001d99d1000000000e0000000000000000000000e00000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000128dd8210000000000000000000000000000000e00000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000228ee8220000000000000000000000000000000e00000000000000000000000000000000000
0000000000000000000001000000000000000000000000000000022deed220000000000000000000000000000000000100000000000000000000000000000000
0000001000000000000000000000000000000000000000000000012d11d210000000000000000000000000000000000000e00000000000000000000000000000
0000000000000000000000000000000000000000000000000000001100110000000000000000000000000000000000e000e00000000000000000001000000000
0000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000e000e00000000000000000000000000000
00000000000000000000000000000e0000000000000000000000000099000000000000000000000000000000000000e000000000000000000000000000000000
00000000000000000000000000000e00000000000000000000000029aa9000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000e0000000000000000000000000077000000000000000000000000000000000000000000e000000000000000000000000000
0000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__sfx__
00010000305502c55026550235501d550195501555012550105500f5500c5500a55009550085500755007550065500750008500045000b5000f500125001f5003050000000000000000000000000000000000000
000100001355013550135500000000000000001355013550135500000000000000000000013550135501355000000000000000000000000000000000000000000000000000000000000000000000000000000000
00010000296502665022650216500d650176500b6500d6500a6500b65003650086501b5501a550086500365003650076500365006650066500665005650056101e5001f500275002750026500285002c50031500
